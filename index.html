<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ramadan Food Ordering</title>

  <!-- ‚úÖ Map (Free) -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

  <style>
    :root{
      --bg1:#fff8e1;
      --bg2:#e6fff7;
      --card:#ffffff;
      --text:#0f172a;
      --muted:#475569;
      --brand:#00695c;
      --brand2:#004d40;
      --accent:#25D366;
      --shadow:0 12px 30px rgba(0,0,0,.12);
      --border:1px solid rgba(0,0,0,.10);
      --radius:16px;
    }
    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: Arial, sans-serif;
      color:var(--text);
      background:
        radial-gradient(1200px 500px at 10% 0%, var(--bg2), transparent),
        radial-gradient(1200px 500px at 90% 0%, #fff0d6, transparent),
        var(--bg1);
    }
    header{
      background: linear-gradient(120deg, var(--brand), var(--brand2));
      color:#fff;
      padding: 26px 16px;
      text-align:center;
      position:sticky;
      top:0;
      z-index:10;
      box-shadow: 0 10px 25px rgba(0,0,0,.12);
    }
    header h1{ margin:0 0 6px 0; font-size:26px; }
    header p{ margin:0; opacity:.95; }

    .wrap{
      max-width: 1100px;
      margin: 0 auto;
      padding: 18px 14px 28px;
      display:grid;
      gap: 14px;
    }
    @media(min-width: 900px){
      .wrap{ grid-template-columns: 1.35fr .65fr; }
    }

    .card{
      background: var(--card);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      border: var(--border);
      padding: 14px;
    }
    .card h2{ margin:0 0 6px 0; font-size:18px; }
    .sub{ margin:0 0 12px 0; color:var(--muted); font-size:13px; }

    .tabs{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin: 10px 0 14px;
    }
    .tab{
      border: var(--border);
      background:#fff;
      padding: 10px 14px;
      border-radius: 12px;
      cursor:pointer;
      font-weight: 800;
      transition:.2s;
    }
    .tab:hover{ transform: translateY(-1px); }
    .tab.active{
      background: #eafff3;
      border-color: rgba(37,211,102,.55);
      color: #0b3b22;
      box-shadow: 0 8px 18px rgba(37,211,102,.18);
    }

    .sectionTitle{
      display:flex;
      justify-content:space-between;
      align-items:baseline;
      margin: 14px 0 8px;
    }
    .sectionTitle h3{ margin:0; font-size:16px; }
    .sectionTitle span{ color:var(--muted); font-size:12px; }

    .items{ display:grid; gap:10px; }
    @media(min-width: 680px){
      .items{ grid-template-columns: 1fr 1fr; }
    }

    .item{
      border: var(--border);
      border-radius: 14px;
      padding: 12px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap: 10px;
      background: linear-gradient(180deg, #ffffff, #fbfffe);
      transition:.15s;
    }
    .item:hover{ transform: translateY(-1px); }

    .info h4{ margin:0 0 4px 0; font-size:15px; }
    .info p{ margin:0; font-size:12px; color:var(--muted); }

    .priceLine{
      font-size:12px;
      font-weight:900;
      color:#0b3b22;
      margin-top:6px;
    }

    .qty{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 8px;
      background: #f1f5f9;
      padding: 8px;
      border-radius: 14px;
      min-width: 140px;
    }
    .qbtn{
      border:none;
      width: 32px;
      height: 32px;
      border-radius: 12px;
      cursor:pointer;
      font-size: 18px;
      font-weight: 900;
      color:#fff;
      background: linear-gradient(120deg, var(--brand2), var(--brand));
      transition:.15s;
    }
    .qbtn:hover{ transform: scale(1.03); }
    .qbtn:disabled{ opacity:.35; cursor:not-allowed; transform:none; }
    .qnum{ width: 30px; text-align:center; font-weight: 900; }

    .row{
      display:flex;
      justify-content:space-between;
      margin: 8px 0;
      font-size: 14px;
    }
    .row strong{ font-size: 15px; }

    label{
      display:block;
      margin-top: 10px;
      margin-bottom: 6px;
      font-size: 12px;
      color: var(--muted);
    }
    input, textarea{
      width:100%;
      padding: 11px 12px;
      border-radius: 12px;
      border: var(--border);
      outline:none;
      font-size: 14px;
      background:#fff;
    }
    textarea{ min-height: 90px; resize:vertical; }

    #map{
      height: 300px;
      border-radius: 12px;
      margin-bottom: 8px;
      border: 1px solid rgba(0,0,0,.10);
      overflow:hidden;
    }

    .actions{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top: 12px;
    }
    .btn{
      border:none;
      padding: 12px 14px;
      border-radius: 14px;
      cursor:pointer;
      font-weight: 900;
      font-size: 14px;
      transition:.15s;
    }
    .btn:hover{ transform: translateY(-1px); }
    .btn.primary{
      background: linear-gradient(120deg, #1da851, var(--accent));
      color:#fff;
      flex:1;
      min-width: 220px;
    }
    .btn.secondary{ background:#e2e8f0; color:#0f172a; }
    .btn.danger{ background:#ef4444; color:#fff; }

    .note{
      margin-top: 10px;
      font-size: 12px;
      color: var(--muted);
      line-height: 1.4;
    }

    footer{
      text-align:center;
      padding: 14px;
      margin-top: 10px;
      color:#fff;
      background: linear-gradient(120deg, var(--brand), var(--brand2));
    }
    .tiny{ font-size: 12px; opacity:.95; }
  </style>
</head>

<body>
<header>
  <h1>üåô Ramadan Food Ordering</h1>
  <p>Iftar ‚Ä¢ Dinner ‚Ä¢ Suhur ‚Äî prices ‚Ä¢ GPS ‚Ä¢ distance ‚Ä¢ pre-order ‚Ä¢ WhatsApp order</p>
</header>

<div class="wrap">
  <!-- LEFT -->
  <div class="card">
    <h2 id="mealTitle">Iftar Menu</h2>
    <p class="sub">Choose a meal time, then press + / ‚àí to set quantities.</p>

    <div class="tabs" id="tabs">
      <button class="tab active" data-meal="iftar" type="button">Iftar</button>
      <button class="tab" data-meal="dinner" type="button">Dinner</button>
      <button class="tab" data-meal="suhur" type="button">Suhur</button>
    </div>

    <div id="menuArea"></div>
  </div>

  <!-- RIGHT -->
  <div class="card">
    <h2>Order Summary</h2>
    <div class="row"><span>Current Meal</span><strong id="mealName">Iftar</strong></div>
    <div class="row"><span>Items in This Meal</span><strong id="totalItems">0</strong></div>
    <div class="row"><span>Items in Full Day</span><strong id="totalAll">0</strong></div>
    <div class="row"><span>Total Amount</span><strong id="totalPrice">‚Çπ0</strong></div>
    <div class="row"><span>Delivery Distance</span><strong id="distanceText">0 km</strong></div>

    <label>Your Name</label>
    <input id="custName" placeholder="Enter your name" />

    <label>Phone Number</label>
    <input id="custPhone" placeholder="Enter phone number" />

    <label>Delivery Date (Pre-order required)</label>
    <input type="date" id="deliveryDate" />
    <div class="note" style="margin-top:6px;">‚úÖ Orders must be placed at least 1 day before delivery.</div>

    <label>Select Your Location</label>
    <div style="display:flex;gap:10px;flex-wrap:wrap;margin-bottom:10px;">
      <button class="btn secondary" id="useMyLocation" type="button">üìç Use My Current Location</button>
    </div>

    <div id="map"></div>

    <label>Selected Address (auto from map)</label>
    <textarea id="custAddress" placeholder="Click on map or use GPS button"></textarea>

    <label>Note (optional)</label>
    <input id="custNote" placeholder="Eg: less spicy / extra gravy" />

    <div class="actions">
      <button class="btn primary" id="sendWhatsApp" type="button">Send This Meal</button>
      <button class="btn primary" id="sendAllMeals" type="button">Send Full Day Order</button>
      <button class="btn secondary" id="copyText" type="button">Copy This Meal Text</button>
      <button class="btn danger" id="clearAll" type="button">Clear This Meal</button>
    </div>

    <div class="note">
      ‚úÖ Map picker + GPS auto-detect + distance calculation included.<br/>
      ‚úÖ Pre-order rule: delivery date must be at least tomorrow.<br/>
      ‚úÖ Prices & totals included in WhatsApp message.<br/>
    </div>
  </div>
</div>

<footer>
  <div class="tiny">Ramadan Mubarak üåô ‚Ä¢ Hosted on GitHub Pages</div>
</footer>

<script>
  // ‚úÖ CHANGE THIS (example India: "919876543210")
  const YOUR_WHATSAPP_NUMBER = "9567717335";

  // ‚úÖ SET YOUR SHOP LOCATION (CHANGE THESE)
  const SHOP_NAME = "shainy's Kitchen";
  const SHOP_LAT = 10.033965;   // <-- Put your shop latitude
  const SHOP_LNG = 76.312313;   // <-- Put your shop longitude

  // ‚úÖ DINNER MENU (SAME FOR SUHUR) ‚Äî prices in ‚Çπ
  const DINNER_MENU = {
    "Breads": [
      { id:"appam", name:"Appam", desc:"Soft Kerala appam", price: 12 },
      { id:"chapati", name:"Chapati", desc:"Fresh homemade chapati", price: 10 },
      { id:"porotta", name:"Porotta", desc:"Kerala style flaky porotta", price: 15 },
      { id:"idiyappam", name:"Idiyappam", desc:"Soft steamed string hoppers", price: 15 },
      { id:"puttu", name:"Puttu", desc:"Traditional Kerala puttu", price: 25 },
    ],
    "Curries": [
      { id:"chickencurry", name:"Chicken Curry", desc:"Spicy homemade chicken curry", price: 120 },
      { id:"butterchicken", name:"Butter Chicken", desc:"Creamy butter chicken masala", price: 140 },
      { id:"beefcurry", name:"Beef Curry", desc:"Kerala style beef curry", price: 130 },
      { id:"eggcurry", name:"Egg Curry", desc:"Traditional egg masala curry", price: 60 },
    ],
    "Drinks": [
      { id:"freshjuice", name:"Fresh Juice", desc:"Mango / Orange / Lime & more", price: 50 }
    ]
  };

  // ‚úÖ IFTAR MENU ‚Äî prices in ‚Çπ
  const MENU = {
    iftar: {
      "Cut Fruits": [
        { id:"cut_apple", name:"Cut Apple", desc:"Fresh apple slices", price: 50 },
        { id:"cut_banana", name:"Cut Banana", desc:"Fresh banana slices", price: 40 },
        { id:"cut_watermelon", name:"Watermelon", desc:"Fresh watermelon cubes", price: 40 },
        { id:"cut_mix", name:"Mixed Fruit Bowl", desc:"Apple + banana + watermelon mix", price: 60 },
      ],
      "Juice": [
        { id:"juice_mango", name:"Mango Juice", desc:"Fresh mango juice", price: 69 },
        { id:"juice_orange", name:"Orange Juice", desc:"Fresh orange juice", price: 69 },
        { id:"juice_lime", name:"Lime Juice", desc:"Fresh lime juice", price: 40 },
      ],
      "Snacks": [
        { id:"snack_samosa", name:"Samosa", desc:"chiken", price: 15 },
        { id:"snack_cutlet", name:"Cutlet", desc:" chicken cutlet", price: 20 },
        { id:"snack_pakora", name:"Pakora", desc:"onion/potato", price: 25 },
        { id:"snack_roll", name:"Roll", desc:"Chicken", price: 50 },
      ]
    },
    dinner: DINNER_MENU,
    suhur: DINNER_MENU
  };

  // ‚úÖ Separate carts per meal
  const cartByMeal = { iftar:{}, dinner:{}, suhur:{} };
  let currentMeal = "iftar";

  const tabs = document.getElementById("tabs");
  const menuArea = document.getElementById("menuArea");
  const mealName = document.getElementById("mealName");
  const mealTitle = document.getElementById("mealTitle");
  const totalItems = document.getElementById("totalItems");
  const totalAll = document.getElementById("totalAll");
  const totalPriceEl = document.getElementById("totalPrice");
  const distanceTextEl = document.getElementById("distanceText");

  // ---------- Pre-order date (tomorrow min) ----------
  function setMinDeliveryDate(){
    const dateInput = document.getElementById("deliveryDate");
    const now = new Date();
    now.setDate(now.getDate() + 1); // tomorrow

    const yyyy = now.getFullYear();
    const mm = String(now.getMonth() + 1).padStart(2, "0");
    const dd = String(now.getDate()).padStart(2, "0");

    dateInput.min = `${yyyy}-${mm}-${dd}`;
    if(!dateInput.value) dateInput.value = dateInput.min;
  }

  function validatePreOrderDate(){
    const val = document.getElementById("deliveryDate").value;
    if(!val){
      alert("Please select delivery date.");
      return false;
    }
    const selected = new Date(val + "T00:00:00");
    const min = new Date();
    min.setHours(0,0,0,0);
    min.setDate(min.getDate() + 1); // tomorrow

    if(selected < min){
      alert("‚ùå Pre-order required: Please select a delivery date at least 1 day from today.");
      return false;
    }
    return true;
  }

  // ---------- Helpers ----------
  function titleCase(s){ return s.charAt(0).toUpperCase() + s.slice(1); }
  function getCart(){ return cartByMeal[currentMeal]; }

  function setMeal(meal){
    currentMeal = meal;
    mealName.textContent = titleCase(meal);
    mealTitle.textContent = `${titleCase(meal)} Menu`;
    renderMenu();
    updateSummary();
  }

  function inc(id){
    const cart = getCart();
    cart[id] = (cart[id] || 0) + 1;
    renderMenu();
    updateSummary();
  }

  function dec(id){
    const cart = getCart();
    const next = Math.max(0, (cart[id] || 0) - 1);
    if(next === 0) delete cart[id];
    else cart[id] = next;
    renderMenu();
    updateSummary();
  }

  function countCart(cart){
    return Object.values(cart).reduce((a,b)=>a+b,0);
  }

  function getTotalCount(){
    return countCart(getCart());
  }

  function getTotalAllMeals(){
    return countCart(cartByMeal.iftar) + countCart(cartByMeal.dinner) + countCart(cartByMeal.suhur);
  }

  function getMealTotal(mealKey){
    const data = MENU[mealKey];
    const cart = cartByMeal[mealKey];
    let total = 0;
    for(const section in data){
      for(const it of data[section]){
        const qty = cart[it.id] || 0;
        total += qty * (it.price || 0);
      }
    }
    return total;
  }

  function getFullDayTotal(){
    return getMealTotal("iftar") + getMealTotal("dinner") + getMealTotal("suhur");
  }

  // ---------- Render Menu ----------
  function renderMenu(){
    const data = MENU[currentMeal];
    const cart = getCart();
    let html = "";

    for(const section in data){
      const items = data[section];
      html += `
        <div class="sectionTitle">
          <h3>${section}</h3>
          <span>${items.length} items</span>
        </div>
        <div class="items">
      `;

      for(const it of items){
        const q = cart[it.id] || 0;
        const lineTotal = q * (it.price || 0);

        html += `
          <div class="item">
            <div class="info">
              <h4>${it.name}</h4>
              <p>${it.desc}</p>
              <div class="priceLine">‚Çπ${it.price} each ‚Ä¢ Subtotal: ‚Çπ${lineTotal}</div>
            </div>
            <div class="qty">
              <button class="qbtn" ${q===0 ? "disabled": ""} onclick="dec('${it.id}')" type="button">‚àí</button>
              <div class="qnum">${q}</div>
              <button class="qbtn" onclick="inc('${it.id}')" type="button">+</button>
            </div>
          </div>
        `;
      }

      html += `</div>`;
    }
    menuArea.innerHTML = html;
  }

  // ---------- Build WhatsApp Text ----------
  function buildMealItemsText(mealKey){
    const data = MENU[mealKey];
    const cart = cartByMeal[mealKey];
    const lines = [];
    let total = 0;

    for(const section in data){
      for(const it of data[section]){
        const qty = cart[it.id] || 0;
        if(qty > 0){
          const line = qty * it.price;
          total += line;
          lines.push(`- ${it.name} x ${qty} (‚Çπ${it.price}) = ‚Çπ${line}`);
        }
      }
    }

    return {
      text: lines.length ? lines.join("\n") : "(No items selected)",
      total
    };
  }

  function getDeliveryInfoText(){
    const addr = document.getElementById("custAddress").value.trim();
    const dist = distanceTextEl.textContent;
    const delDate = document.getElementById("deliveryDate").value;
    return `Delivery Date: ${delDate || "-"}\nAddress:\n${addr || "-"}\nDistance: ${dist}`;
  }

  function buildThisMealText(){
    const name = document.getElementById("custName").value.trim();
    const phone = document.getElementById("custPhone").value.trim();
    const note = document.getElementById("custNote").value.trim();

    const mealData = buildMealItemsText(currentMeal);

    return (
`Ramadan Order üåô
Meal: ${currentMeal.toUpperCase()}

Customer:
Name: ${name || "-"}
Phone: ${phone || "-"}

${getDeliveryInfoText()}

Items:
${mealData.text}

Meal Total: ‚Çπ${mealData.total}

Note: ${note || "-"}`
    );
  }

  function buildFullDayOrderText(){
    const name = document.getElementById("custName").value.trim();
    const phone = document.getElementById("custPhone").value.trim();
    const note = document.getElementById("custNote").value.trim();

    const iftar = buildMealItemsText("iftar");
    const dinner = buildMealItemsText("dinner");
    const suhur = buildMealItemsText("suhur");

    const grand = iftar.total + dinner.total + suhur.total;

    return (
`Ramadan Full Day Order üåô

Customer:
Name: ${name || "-"}
Phone: ${phone || "-"}

${getDeliveryInfoText()}

IFTAR:
${iftar.text}
Iftar Total: ‚Çπ${iftar.total}

DINNER:
${dinner.text}
Dinner Total: ‚Çπ${dinner.total}

SUHUR:
${suhur.text}
Suhur Total: ‚Çπ${suhur.total}

GRAND TOTAL: ‚Çπ${grand}

Note: ${note || "-"}`
    );
  }

  function updateSummary(){
    totalItems.textContent = getTotalCount();
    totalAll.textContent = getTotalAllMeals();
    totalPriceEl.textContent = "‚Çπ" + getFullDayTotal();
    // distanceTextEl updated by map functions
  }

  // ---------- Tabs ----------
  tabs.addEventListener("click", (e)=>{
    const btn = e.target.closest(".tab");
    if(!btn) return;

    document.querySelectorAll(".tab").forEach(t=>t.classList.remove("active"));
    btn.classList.add("active");

    setMeal(btn.dataset.meal);
  });

  // ---------- Buttons ----------
  document.getElementById("sendWhatsApp").addEventListener("click", ()=>{
    if(YOUR_WHATSAPP_NUMBER.includes("X")){
      alert("Please set your WhatsApp number in code: YOUR_WHATSAPP_NUMBER");
      return;
    }
    if(!validatePreOrderDate()) return;

    const name = document.getElementById("custName").value.trim();
    const phone = document.getElementById("custPhone").value.trim();
    const address = document.getElementById("custAddress").value.trim();

    if(!name || !phone || !address){
      alert("Please enter Name, Phone, and choose location/address.");
      return;
    }

    const cart = getCart();
    if(Object.keys(cart).length === 0){
      alert("Please select at least 1 item in this meal using + button.");
      return;
    }

    const text = buildThisMealText();
    const waUrl = `https://wa.me/${YOUR_WHATSAPP_NUMBER}?text=${encodeURIComponent(text)}`;
    window.open(waUrl, "_blank");
  });

  document.getElementById("sendAllMeals").addEventListener("click", ()=>{
    if(YOUR_WHATSAPP_NUMBER.includes("X")){
      alert("Please set your WhatsApp number in code: YOUR_WHATSAPP_NUMBER");
      return;
    }
    if(!validatePreOrderDate()) return;

    const name = document.getElementById("custName").value.trim();
    const phone = document.getElementById("custPhone").value.trim();
    const address = document.getElementById("custAddress").value.trim();

    if(!name || !phone || !address){
      alert("Please enter Name, Phone, and choose location/address.");
      return;
    }

    const hasAny =
      Object.keys(cartByMeal.iftar).length > 0 ||
      Object.keys(cartByMeal.dinner).length > 0 ||
      Object.keys(cartByMeal.suhur).length > 0;

    if(!hasAny){
      alert("Please select at least 1 item in Iftar/Dinner/Suhur.");
      return;
    }

    const text = buildFullDayOrderText();
    const waUrl = `https://wa.me/${YOUR_WHATSAPP_NUMBER}?text=${encodeURIComponent(text)}`;
    window.open(waUrl, "_blank");
  });

  document.getElementById("copyText").addEventListener("click", async ()=>{
    const text = buildThisMealText();
    try{
      await navigator.clipboard.writeText(text);
      alert("Order text copied ‚úÖ");
    }catch{
      alert("Copy failed. Here is the text:\n\n" + text);
    }
  });

  document.getElementById("clearAll").addEventListener("click", ()=>{
    cartByMeal[currentMeal] = {};
    document.getElementById("custNote").value = "";
    renderMenu();
    updateSummary();
  });

  // expose for onclick
  window.inc = inc;
  window.dec = dec;

  // ---------- MAP + GPS + DISTANCE ----------
  function haversineKm(lat1, lon1, lat2, lon2){
    const R = 6371;
    const toRad = (x) => x * Math.PI / 180;
    const dLat = toRad(lat2 - lat1);
    const dLon = toRad(lon2 - lon1);

    const a =
      Math.sin(dLat/2) * Math.sin(dLat/2) +
      Math.cos(toRad(lat1)) * Math.cos(toRad(lat2)) *
      Math.sin(dLon/2) * Math.sin(dLon/2);

    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
    return R * c;
  }

  let selectedLat = null;
  let selectedLng = null;

  function updateDistanceUI(){
    if(selectedLat == null || selectedLng == null){
      distanceTextEl.textContent = "0 km";
      return;
    }
    const km = haversineKm(SHOP_LAT, SHOP_LNG, selectedLat, selectedLng);
    distanceTextEl.textContent = km.toFixed(2) + " km";
  }

  const map = L.map('map').setView([SHOP_LAT, SHOP_LNG], 12);

  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '¬© OpenStreetMap'
  }).addTo(map);

  L.marker([SHOP_LAT, SHOP_LNG]).addTo(map).bindPopup(`üè™ ${SHOP_NAME}`).openPopup();

  let marker;

  function setCustomerLocation(lat, lng){
    selectedLat = lat;
    selectedLng = lng;

    if(marker) map.removeLayer(marker);

    marker = L.marker([lat, lng]).addTo(map).bindPopup("üìç Your Location").openPopup();
    map.setView([lat, lng], 15);

    updateDistanceUI();

    fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lng}`)
      .then(r => r.json())
      .then(data => {
        const addr = data?.display_name || `Lat: ${lat}, Lng: ${lng}`;
        document.getElementById("custAddress").value =
          `${addr}\nGoogle Maps: https://www.google.com/maps?q=${lat},${lng}\nDistance: ${distanceTextEl.textContent}`;
      })
      .catch(() => {
        document.getElementById("custAddress").value =
          `Lat: ${lat}, Lng: ${lng}\nGoogle Maps: https://www.google.com/maps?q=${lat},${lng}\nDistance: ${distanceTextEl.textContent}`;
      });
  }

  map.on('click', (e)=>{
    setCustomerLocation(e.latlng.lat, e.latlng.lng);
  });

  document.getElementById("useMyLocation").addEventListener("click", ()=>{
    if(!navigator.geolocation){
      alert("GPS not supported in this browser.");
      return;
    }
    navigator.geolocation.getCurrentPosition(
      (pos)=>{
        setCustomerLocation(pos.coords.latitude, pos.coords.longitude);
      },
      ()=>{
        alert("Could not get GPS location. Please allow location permission or click on map.");
      },
      { enableHighAccuracy:true, timeout:10000 }
    );
  });

  // Auto detect on load (asks permission)
  window.addEventListener("load", ()=>{
    setMinDeliveryDate();

    if(!navigator.geolocation) return;
    navigator.geolocation.getCurrentPosition(
      (pos)=>{ setCustomerLocation(pos.coords.latitude, pos.coords.longitude); },
      ()=>{},
      { enableHighAccuracy:true, timeout:6000 }
    );
  });

  // ---------- INIT ----------
  renderMenu();
  updateSummary();
</script>
</body>
</html>
